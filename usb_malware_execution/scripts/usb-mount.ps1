<#
.SYNOPSIS
Creates a simulated USB directory mapped to E: using subst.

.NOTES
Author: Jason Nguyen  
Date: July 2, 2025

.DESCRIPTION
This script creates a folder at C:\SimulatedUSB\Payload and maps it to drive letter E:.
This simulates a USB device insertion for testing malware or threat hunting scenarios.

.USAGE
Run this script in an elevated PowerShell session.
#>

# Set base path
$usbBasePath = "C:\SimulatedUSB"
$payloadPath = Join-Path $usbBasePath "Payload"

# Create folder structure
New-Item -ItemType Directory -Path $payloadPath -Force | Out-Null

# Map the USB folder to drive E:
subst E: $usbBasePath

# Confirm it worked
if (Test-Path "E:\Payload") {
    Write-Host "`n✅ Simulated USB drive mounted at E:\Payload"
} else {
    Write-Warning "`n⚠️ Failed to mount E: drive. Check permissions or path."
}
